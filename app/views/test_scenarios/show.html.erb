<%= render "shared/header" %>

<div class="container-fluid">
	<div class="row-fluid">
		<%= render 'shared/side_bar' %>
		
		<div class="col-md-12 contents">
			<div class="page-title">
				<img src="/assets/scenario.png">Test Scenarios
			</div>
			<div class="below-page-title">Test Scenarios > Test Scenario</div>

			<div class="scenario-info" >
				<div class="scenario-info-title">
					<span class="scenario-rank"><%= @test_scenario.get_rank %></span>
					<span class="scenario-name"><%= @test_scenario.name %></span>
					<%= link_to edit_project_test_scenario_path(@project, @test_scenario) do%>
						<div class="edit-button"></div>
					<% end %>
				</div>
				<div class="detail_content"><%= @test_scenario.description %></div>
				<div class="recently_tested">recently tested on: <%= @test_scenario.recent_test_date %></div>
			</div>

			<span class="page-subtitle">Event Path</span>
			<div class="event-flow-row">
				<div class="event-flow">
					<div id="event-flow-inner"></div>
				</div>
				<div id="event-detail">Click on event for more detail</div>
			<div>

			<%= link_to "Export Code", @test_scenario.export_code, class: "btn btn-info" %>	
			
			
			<div class="table-wrapper">
			<div class="edit-button"></div>
			<%= nested_form_for([@project, @test_scenario]) do |f| %>
			  <table class="motion-events-table">
			  	<tr>
			  		<th>Activity</th>
			  		<th>View</th>
			  		<th>Event Type</th>
			  		<th>Parameter</th>
			  	</tr>
					<%= f.fields_for :motion_events do |builder| %>
						<tr>
				  		<tr><%= builder.object.activity_class %></tr>
				  		<tr><%= builder.object.view %></tr>
				  		<tr><%= builder.object.action_type %></tr>
				  		<tr><%= builder.text_field :param %></tr>
				  	</tr>
					<% end %>
			  </table>
			<% end %>
			</div>
		</div>
	</div>
	
</div>

<%= javascript_tag do %>
	d3.json("/api/v1/test_scenarios/<%= @test_scenario.id %>/motion_event_list",drawEventFlow);
<% end %>


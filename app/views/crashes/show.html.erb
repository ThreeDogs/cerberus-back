<%= render "shared/header" %>

<div class="container-fluid">
	<div class="row-fluid">
		<%= render 'shared/side_bar' %>	
		<div class="col-md-12 contents">
			
			<div class="page-title">
				<img src="/assets/Result.png">Crash Report
			</div>
			<div class="below-page-title">Test Result > Full Report > Crash Report</div>

			<span class="page-subtitle">Error Summary</span>
			<div class="error-summary">
				<div class="status-icon"></div>
				<div class="error-line">
					<h5><%= @crash.error_name %></h5>
					<span><%= @crash.error_line %></span>
				</div>
			</div>
			
			<div class="crash-graph">
				<div id="test-rank-rate" class="crash-graph-each">Test Rank</div>
				<div id="os-version-rate" class="crash-graph-each">OS Version</div>
				<div id="device-rate" class="crash-graph-each">Device</div>
				<div id="country-rate" class="crash-graph-each">Country</div>
			</div>
			
			<span class="page-subtitle">Stack Trace</span>
			<div class="stack-trace">
				<%= @crash.description %>
			</div>
			<span class="page-subtitle">Event Path</span>
			<div class="event-path">
				//TODO: NEED EVENT PATH DATA
			</div>

			<span class="page-subtitle">Detail Reports</span>
			<div class="detail-report-list">
				<table class="all-errors-table">
					<tr>
						<th>Rank</th>
						<th>Test Name</th>
						<th>OS Version</th>
						<th>Device</th>
						<th>Country</th>
						<th></th>
					</tr>
					<% @detail_reports.each do |detail_report| %>
						<tr>
							<td><div class="rank <%= detail_report.rank %>"><%= detail_report.rank %></div></td>
							<td><%= detail_report.test_scenario_name %></td>
							<td><%= detail_report.os_version %></td>
							<td><%= detail_report.device_name %></td>
							<td><%= detail_report.device_country %></td>
							<td><%= link_to total_report_detail_report_path(@total_report,detail_report) do %><div class="show-button"></div><% end %></td>
						</tr>
					<% end %>
				</table>
			</div>
		</div>
	</div>
</div>

<script>
// Test rank Rate <%= @crash.test_rank_rate %>
// OS Version <%= @crash.os_version_rate %>
// Device <%= @crash.device_rate %>
// Country <%= @crash.country_rate %>
var testdata = {
	"A": 3,
	"B": 5,
	"C": 7,
	"D": 9
}
drawRatePieChart("test-rank-rate", testdata);
drawRatePieChart("os-version-rate", testdata);
drawRatePieChart("device-rate", testdata);
drawRatePieChart("country-rate", testdata);
</script>